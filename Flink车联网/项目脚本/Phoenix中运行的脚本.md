[TOC]

## 原始数据落地HBase时在Phoenix中创建映射表跟视图

HBase里面只有rowkey作为一级索引，如果要对库里的非rowkey字段进行数据检索和查询，往往要通过MapReduce/Spark等分布式计算框架进行，硬件资源消耗和时间延迟都会比较高。

为了HBase的数据查询更高效、适应更多的场景， 诸如使用非rowkey字段检索也能做到秒级响应，或者支持各个字段进行模糊查询和多字段组合查询等， 因此需要在HBase上面构建二级索引， 以满足现实中更复杂多样的业务需求

### Phoenix中创建HBase二级索引表

原始数据实时ETL创建好表，且表中存储了大量车辆信息数据，为了提高查询的效率和查询维度，通过phoenix建立hbase的二级索引方式实现。

HBase中已存在“itcast src”表，因此我们需要在phoenix中创建对应hbase的表，此表创建好二级索引，我们就可以通过除rowkey外的其他列进行高效的组合查询

```sql
create table if not exists "vehicle_rightdata"(
PK VARCHAR PRIMARY KEY,
"cf"."vin" VARCHAR,
"cf"."terminalTime" VARCHAR,
"cf"."soc" VARCHAR,
"cf"."lat" VARCHAR,
"cf"."lng" VARCHAR,
"cf"."gearDriveForce" VARCHAR,
"cf"."batteryConsistencyDifferenceAlarm" VARCHAR,
"cf"."socJumpAlarm" VARCHAR,
"cf"."caterpillaringFunction" VARCHAR,
"cf"."satNum" VARCHAR,
"cf"."socLowAlarm" VARCHAR,
"cf"."chargingGunConnectionState" VARCHAR,
"cf"."minTemperatureSubSystemNum" VARCHAR,
"cf"."chargedElectronicLockStatus" VARCHAR,
"cf"."maxVoltageBatteryNum" VARCHAR,
"cf"."singleBatteryOverVoltageAlarm" VARCHAR,
"cf"."otherFaultCount" VARCHAR,
"cf"."vehicleStorageDeviceOvervoltageAlarm" VARCHAR,
"cf"."brakeSystemAlarm" VARCHAR,
"cf"."serverTime" VARCHAR,
"cf"."rechargeableStorageDevicesFaultCount" VARCHAR,
"cf"."driveMotorTemperatureAlarm" VARCHAR,
"cf"."gearBrakeForce" VARCHAR,
"cf"."dcdcStatusAlarm" VARCHAR,
"cf"."driveMotorFaultCodes" VARCHAR,
"cf"."deviceType" VARCHAR,
"cf"."vehicleSpeed" VARCHAR,
"cf"."chargingTimeExtensionReason" VARCHAR,
"cf"."currentBatteryStartNum" VARCHAR,
"cf"."batteryVoltage" VARCHAR,
"cf"."chargeSystemVoltage" VARCHAR,
"cf"."currentBatteryCount" VARCHAR,
"cf"."batteryCount" VARCHAR,
"cf"."childSystemNum" VARCHAR,
"cf"."chargeSystemCurrent" VARCHAR,
"cf"."gpsTime" VARCHAR,
"cf"."engineFaultCount" VARCHAR,
"cf"."carId" VARCHAR,
"cf"."currentElectricity" VARCHAR,
"cf"."singleBatteryUnderVoltageAlarm" VARCHAR,
"cf"."maxVoltageBatterySubSystemNum" VARCHAR,
"cf"."minTemperatureProbe" VARCHAR,
"cf"."driveMotorNum" VARCHAR,
"cf"."totalVoltage" VARCHAR,
"cf"."temperatureDifferenceAlarm" VARCHAR,
"cf"."maxAlarmLevel" VARCHAR,
"cf"."status" VARCHAR,
"cf"."geerPosition" VARCHAR,
"cf"."averageEnergyConsumption" VARCHAR,
"cf"."minVoltageBattery" VARCHAR,
"cf"."geerStatus" VARCHAR,
"cf"."controllerInputVoltage" VARCHAR,
"cf"."controllerTemperature" VARCHAR,
"cf"."revolutionSpeed" VARCHAR,
"cf"."num" VARCHAR,
"cf"."controllerDcBusCurrent" VARCHAR,
"cf"."temperature" VARCHAR,
"cf"."torque" VARCHAR,
"cf"."state" VARCHAR,
"cf"."minVoltageBatteryNum" VARCHAR,
"cf"."validGps" VARCHAR,
"cf"."engineFaultCodes" VARCHAR,
"cf"."minTemperatureValue" VARCHAR,
"cf"."chargeStatus" VARCHAR,
"cf"."ignitionTime" VARCHAR,
"cf"."totalOdometer" VARCHAR,
"cf"."alti" VARCHAR,
"cf"."speed" VARCHAR,
"cf"."socHighAlarm" VARCHAR,
"cf"."vehicleStorageDeviceUndervoltageAlarm" VARCHAR,
"cf"."totalCurrent" VARCHAR,
"cf"."batteryAlarm" VARCHAR,
"cf"."rechargeableStorageDeviceMismatchAlarm" VARCHAR,
"cf"."isHistoryPoi" VARCHAR,
"cf"."vehiclePureDeviceTypeOvercharge" VARCHAR,
"cf"."maxVoltageBattery" VARCHAR,
"cf"."dcdcTemperatureAlarm" VARCHAR,
"cf"."isValidGps" VARCHAR,
"cf"."lastUpdatedTime" VARCHAR,
"cf"."driveMotorControllerTemperatureAlarm" VARCHAR,
"cf"."probeTemperatures" VARCHAR,
"cf"."chargeTemperatureProbeNum" VARCHAR,
"cf"."igniteCumulativeMileage" VARCHAR,
"cf"."dcStatus" VARCHAR,
"cf"."repay" VARCHAR,
"cf"."maxTemperatureSubSystemNum" VARCHAR,
"cf"."carStatus" VARCHAR,
"cf"."minVoltageBatterySubSystemNum" VARCHAR,
"cf"."heading" VARCHAR,
"cf"."driveMotorFaultCount" VARCHAR,
"cf"."tuid" VARCHAR,
"cf"."energyRecoveryStatus" VARCHAR,
"cf"."fireStatus" VARCHAR,
"cf"."targetType" VARCHAR,
"cf"."maxTemperatureProbe" VARCHAR,
"cf"."rechargeableStorageDevicesFaultCodes" VARCHAR,
"cf"."carMode" VARCHAR,
"cf"."highVoltageInterlockStateAlarm" VARCHAR,
"cf"."insulationAlarm" VARCHAR,
"cf"."mileageInformation" VARCHAR,
"cf"."maxTemperatureValue" VARCHAR,
"cf"."otherFaultCodes" VARCHAR,
"cf"."remainPower" VARCHAR,
"cf"."insulateResistance" VARCHAR,
"cf"."batteryLowTemperatureHeater" VARCHAR,
"cf"."fuelConsumption100km" VARCHAR,
"cf"."fuelConsumption" VARCHAR,
"cf"."engineSpeed" VARCHAR,
"cf"."engineStatus" VARCHAR,
"cf"."trunk" VARCHAR,
"cf"."lowBeam" VARCHAR,
"cf"."triggerLatchOverheatProtect" VARCHAR,
"cf"."turnLndicatorRight" VARCHAR,
"cf"."highBeam" VARCHAR,
"cf"."turnLndicatorLeft" VARCHAR,
"cf"."bcuSwVers" VARCHAR,
"cf"."bcuHwVers" VARCHAR,
"cf"."bcuOperMod" VARCHAR,
"cf"."chrgEndReason" VARCHAR,
"cf"."BCURegenEngDisp" VARCHAR,
"cf"."BCURegenCpDisp" VARCHAR,
"cf"."bcuChrgMod" VARCHAR,
"cf"."batteryChargeStatus" VARCHAR,
"cf"."BcuFaultCodes" VARCHAR,
"cf"."bcuFltRnk" VARCHAR,
"cf"."battPoleTOver" VARCHAR,
"cf"."bcuSOH" VARCHAR,
"cf"."battIntrHeatActive" VARCHAR,
"cf"."battIntrHeatReq" VARCHAR,
"cf"."BCUBattTarT" VARCHAR,
"cf"."battExtHeatReq" VARCHAR,
"cf"."BCUMaxChrgPwrLongT" VARCHAR,
"cf"."BCUMaxDchaPwrLongT" VARCHAR,
"cf"."BCUTotalRegenEngDisp" VARCHAR,
"cf"."BCUTotalRegenCpDisp" VARCHAR,
"cf"."dcdcFltRnk" VARCHAR,
"cf"."DcdcFaultCode" VARCHAR,
"cf"."dcdcOutpCrrt" VARCHAR,
"cf"."dcdcOutpU" VARCHAR,
"cf"."dcdcAvlOutpPwr" VARCHAR,
"cf"."absActiveStatus" VARCHAR,
"cf"."absStatus" VARCHAR,
"cf"."VcuBrkErr" VARCHAR,
"cf"."EPB_AchievedClampForce" VARCHAR,
"cf"."epbSwitchPosition" VARCHAR,
"cf"."epbStatus" VARCHAR,
"cf"."espActiveStatus" VARCHAR,
"cf"."espFunctionStatus" VARCHAR,
"cf"."ESP_TCSFailStatus" VARCHAR,
"cf"."hhcActive" VARCHAR,
"cf"."tcsActive" VARCHAR,
"cf"."espMasterCylinderBrakePressure" VARCHAR,
"cf"."ESP_MasterCylinderBrakePressureValid" VARCHAR,
"cf"."espTorqSensorStatus" VARCHAR,
"cf"."EPS_EPSFailed" VARCHAR,
"cf"."sasFailure" VARCHAR,
"cf"."sasSteeringAngleSpeed" VARCHAR,
"cf"."sasSteeringAngle" VARCHAR,
"cf"."sasSteeringAngleValid" VARCHAR,
"cf"."espSteeringTorque" VARCHAR,
"cf"."acReq" VARCHAR,
"cf"."acSystemFailure" VARCHAR,
"cf"."ptcPwrAct" VARCHAR,
"cf"."plasmaStatus" VARCHAR,
"cf"."battInTemperature" VARCHAR,
"cf"."battWarmLoopSts" VARCHAR,
"cf"."battCoolngLoopSts" VARCHAR,
"cf"."battCoolActv" VARCHAR,
"cf"."motorOutTemperature" VARCHAR,
"cf"."powerStatusFeedBack" VARCHAR,
"cf"."AC_RearDefrosterSwitch" VARCHAR,
"cf"."rearFoglamp" VARCHAR,
"cf"."driverDoorLock" VARCHAR,
"cf"."acDriverReqTemp" VARCHAR,
"cf"."keyAlarm" VARCHAR,
"cf"."airCleanStsRemind" VARCHAR,
"cf"."recycleType" VARCHAR,
"cf"."startControlsignal" VARCHAR,
"cf"."airBagWarningLamp" VARCHAR,
"cf"."frontDefrosterSwitch" VARCHAR,
"cf"."frontBlowType" VARCHAR,
"cf"."frontReqWindLevel" VARCHAR,
"cf"."bcmFrontWiperStatus" VARCHAR,
"cf"."tmsPwrAct" VARCHAR,
"cf"."keyUndetectedAlarmSign" VARCHAR,
"cf"."positionLamp" VARCHAR,
"cf"."driverReqTempModel" VARCHAR,
"cf"."turnLightSwitchSts" VARCHAR,
"cf"."autoHeadlightStatus" VARCHAR,
"cf"."driverDoor" VARCHAR,
"cf"."IpuFaultCodes" VARCHAR,
"cf"."frntIpuFltRnk" VARCHAR,
"cf"."frontIpuSwVers" VARCHAR,
"cf"."frontIpuHwVers" VARCHAR,
"cf"."frntMotTqLongTermMax" VARCHAR,
"cf"."frntMotTqLongTermMin" VARCHAR,
"cf"."cpvValue" VARCHAR,
"cf"."obcChrgSts" VARCHAR,
"cf"."obcFltRnk" VARCHAR,
"cf"."obcChrgInpAcI" VARCHAR,
"cf"."obcChrgInpAcU" VARCHAR,
"cf"."obcChrgDcI" VARCHAR,
"cf"."obcChrgDcU" VARCHAR,
"cf"."obcTemperature" VARCHAR,
"cf"."obcMaxChrgOutpPwrAvl" VARCHAR,
"cf"."passengerBuckleSwitch" VARCHAR,
"cf"."crashlfo" VARCHAR,
"cf"."driverBuckleSwitch" VARCHAR,
"cf"."engineStartHibit" VARCHAR,
"cf"."lockCommand" VARCHAR,
"cf"."searchCarReq" VARCHAR,
"cf"."acTempValueReq" VARCHAR,
"cf"."VcuFaultCode" VARCHAR,
"cf"."vcuErrAmnt" VARCHAR,
"cf"."vcuSwVers" VARCHAR,
"cf"."vcuHwVers" VARCHAR,
"cf"."lowSpdWarnStatus" VARCHAR,
"cf"."lowBattChrgRqe" VARCHAR,
"cf"."lowBattChrgSts" VARCHAR,
"cf"."lowBattU" VARCHAR,
"cf"."handlebrakeStatus" VARCHAR,
"cf"."shiftPositionValid" VARCHAR,
"cf"."accPedalValid" VARCHAR,
"cf"."driveMode" VARCHAR,
"cf"."driveModeButtonStatus" VARCHAR,
"cf"."VCUSRSCrashOutpSts" VARCHAR,
"cf"."textDispEna" VARCHAR,
"cf"."crsCtrlStatus" VARCHAR,
"cf"."crsTarSpd" VARCHAR,
"cf"."crsTextDisp" VARCHAR,
"cf"."keyOn" VARCHAR,
"cf"."vehPwrlim" VARCHAR,
"cf"."vehCfgInfo" VARCHAR,
"cf"."vacBrkPRmu" VARCHAR,
"cf"."processTime" VARCHAR
)
-- 要让phoenix中建立的表能映射hbase中的表，需要禁用列映射规则（会降低查询性能）
column_encoded_bytes=0;
```

### Phoenix中创建HBase二级索引视图

一般情况在phoenix关联hbase表，不使用建表方式，有2种原因：

- 查询性能低

  - 删除phoenix表，也会把hbase中被映射的表删除(重要，容易造成数据丢失)

  - 删除视图时，实际的表数据不受影响。但是，该视图的索引数据将被删除

```sql
create view if not exists "vehicle_rightdata"(
    -- rowkey可以与hbase中的名称不一样
pk VARCHAR PRIMARY KEY,
"cf"."vin" VARCHAR,
"cf"."terminalTime" VARCHAR,
"cf"."soc" VARCHAR,
"cf"."lat" VARCHAR,
"cf"."lng" VARCHAR,
"cf"."gearDriveForce" VARCHAR,
"cf"."batteryConsistencyDifferenceAlarm" VARCHAR,
"cf"."socJumpAlarm" VARCHAR,
"cf"."caterpillaringFunction" VARCHAR,
"cf"."satNum" VARCHAR,
"cf"."socLowAlarm" VARCHAR,
"cf"."chargingGunConnectionState" VARCHAR,
"cf"."minTemperatureSubSystemNum" VARCHAR,
"cf"."chargedElectronicLockStatus" VARCHAR,
"cf"."maxVoltageBatteryNum" VARCHAR,
"cf"."singleBatteryOverVoltageAlarm" VARCHAR,
"cf"."otherFaultCount" VARCHAR,
"cf"."vehicleStorageDeviceOvervoltageAlarm" VARCHAR,
"cf"."brakeSystemAlarm" VARCHAR,
"cf"."serverTime" VARCHAR,
"cf"."rechargeableStorageDevicesFaultCount" VARCHAR,
"cf"."driveMotorTemperatureAlarm" VARCHAR,
"cf"."gearBrakeForce" VARCHAR,
"cf"."dcdcStatusAlarm" VARCHAR,
"cf"."driveMotorFaultCodes" VARCHAR,
"cf"."deviceType" VARCHAR,
"cf"."vehicleSpeed" VARCHAR,
"cf"."chargingTimeExtensionReason" VARCHAR,
"cf"."currentBatteryStartNum" VARCHAR,
"cf"."batteryVoltage" VARCHAR,
"cf"."chargeSystemVoltage" VARCHAR,
"cf"."currentBatteryCount" VARCHAR,
"cf"."batteryCount" VARCHAR,
"cf"."childSystemNum" VARCHAR,
"cf"."chargeSystemCurrent" VARCHAR,
"cf"."gpsTime" VARCHAR,
"cf"."engineFaultCount" VARCHAR,
"cf"."carId" VARCHAR,
"cf"."currentElectricity" VARCHAR,
"cf"."singleBatteryUnderVoltageAlarm" VARCHAR,
"cf"."maxVoltageBatterySubSystemNum" VARCHAR,
"cf"."minTemperatureProbe" VARCHAR,
"cf"."driveMotorNum" VARCHAR,
"cf"."totalVoltage" VARCHAR,
"cf"."temperatureDifferenceAlarm" VARCHAR,
"cf"."maxAlarmLevel" VARCHAR,
"cf"."status" VARCHAR,
"cf"."geerPosition" VARCHAR,
"cf"."averageEnergyConsumption" VARCHAR,
"cf"."minVoltageBattery" VARCHAR,
"cf"."geerStatus" VARCHAR,
"cf"."controllerInputVoltage" VARCHAR,
"cf"."controllerTemperature" VARCHAR,
"cf"."revolutionSpeed" VARCHAR,
"cf"."num" VARCHAR,
"cf"."controllerDcBusCurrent" VARCHAR,
"cf"."temperature" VARCHAR,
"cf"."torque" VARCHAR,
"cf"."state" VARCHAR,
"cf"."minVoltageBatteryNum" VARCHAR,
"cf"."validGps" VARCHAR,
"cf"."engineFaultCodes" VARCHAR,
"cf"."minTemperatureValue" VARCHAR,
"cf"."chargeStatus" VARCHAR,
"cf"."ignitionTime" VARCHAR,
"cf"."totalOdometer" VARCHAR,
"cf"."alti" VARCHAR,
"cf"."speed" VARCHAR,
"cf"."socHighAlarm" VARCHAR,
"cf"."vehicleStorageDeviceUndervoltageAlarm" VARCHAR,
"cf"."totalCurrent" VARCHAR,
"cf"."batteryAlarm" VARCHAR,
"cf"."rechargeableStorageDeviceMismatchAlarm" VARCHAR,
"cf"."isHistoryPoi" VARCHAR,
"cf"."vehiclePureDeviceTypeOvercharge" VARCHAR,
"cf"."maxVoltageBattery" VARCHAR,
"cf"."dcdcTemperatureAlarm" VARCHAR,
"cf"."isValidGps" VARCHAR,
"cf"."lastUpdatedTime" VARCHAR,
"cf"."driveMotorControllerTemperatureAlarm" VARCHAR,
"cf"."probeTemperatures" VARCHAR,
"cf"."chargeTemperatureProbeNum" VARCHAR,
"cf"."igniteCumulativeMileage" VARCHAR,
"cf"."dcStatus" VARCHAR,
"cf"."repay" VARCHAR,
"cf"."maxTemperatureSubSystemNum" VARCHAR,
"cf"."carStatus" VARCHAR,
"cf"."minVoltageBatterySubSystemNum" VARCHAR,
"cf"."heading" VARCHAR,
"cf"."driveMotorFaultCount" VARCHAR,
"cf"."tuid" VARCHAR,
"cf"."energyRecoveryStatus" VARCHAR,
"cf"."fireStatus" VARCHAR,
"cf"."targetType" VARCHAR,
"cf"."maxTemperatureProbe" VARCHAR,
"cf"."rechargeableStorageDevicesFaultCodes" VARCHAR,
"cf"."carMode" VARCHAR,
"cf"."highVoltageInterlockStateAlarm" VARCHAR,
"cf"."insulationAlarm" VARCHAR,
"cf"."mileageInformation" VARCHAR,
"cf"."maxTemperatureValue" VARCHAR,
"cf"."otherFaultCodes" VARCHAR,
"cf"."remainPower" VARCHAR,
"cf"."insulateResistance" VARCHAR,
"cf"."batteryLowTemperatureHeater" VARCHAR,
"cf"."fuelConsumption100km" VARCHAR,
"cf"."fuelConsumption" VARCHAR,
"cf"."engineSpeed" VARCHAR,
"cf"."engineStatus" VARCHAR,
"cf"."trunk" VARCHAR,
"cf"."lowBeam" VARCHAR,
"cf"."triggerLatchOverheatProtect" VARCHAR,
"cf"."turnLndicatorRight" VARCHAR,
"cf"."highBeam" VARCHAR,
"cf"."turnLndicatorLeft" VARCHAR,
"cf"."bcuSwVers" VARCHAR,
"cf"."bcuHwVers" VARCHAR,
"cf"."bcuOperMod" VARCHAR,
"cf"."chrgEndReason" VARCHAR,
"cf"."BCURegenEngDisp" VARCHAR,
"cf"."BCURegenCpDisp" VARCHAR,
"cf"."bcuChrgMod" VARCHAR,
"cf"."batteryChargeStatus" VARCHAR,
"cf"."BcuFaultCodes" VARCHAR,
"cf"."bcuFltRnk" VARCHAR,
"cf"."battPoleTOver" VARCHAR,
"cf"."bcuSOH" VARCHAR,
"cf"."battIntrHeatActive" VARCHAR,
"cf"."battIntrHeatReq" VARCHAR,
"cf"."BCUBattTarT" VARCHAR,
"cf"."battExtHeatReq" VARCHAR,
"cf"."BCUMaxChrgPwrLongT" VARCHAR,
"cf"."BCUMaxDchaPwrLongT" VARCHAR,
"cf"."BCUTotalRegenEngDisp" VARCHAR,
"cf"."BCUTotalRegenCpDisp" VARCHAR,
"cf"."dcdcFltRnk" VARCHAR,
"cf"."DcdcFaultCode" VARCHAR,
"cf"."dcdcOutpCrrt" VARCHAR,
"cf"."dcdcOutpU" VARCHAR,
"cf"."dcdcAvlOutpPwr" VARCHAR,
"cf"."absActiveStatus" VARCHAR,
"cf"."absStatus" VARCHAR,
"cf"."VcuBrkErr" VARCHAR,
"cf"."EPB_AchievedClampForce" VARCHAR,
"cf"."epbSwitchPosition" VARCHAR,
"cf"."epbStatus" VARCHAR,
"cf"."espActiveStatus" VARCHAR,
"cf"."espFunctionStatus" VARCHAR,
"cf"."ESP_TCSFailStatus" VARCHAR,
"cf"."hhcActive" VARCHAR,
"cf"."tcsActive" VARCHAR,
"cf"."espMasterCylinderBrakePressure" VARCHAR,
"cf"."ESP_MasterCylinderBrakePressureValid" VARCHAR,
"cf"."espTorqSensorStatus" VARCHAR,
"cf"."EPS_EPSFailed" VARCHAR,
"cf"."sasFailure" VARCHAR,
"cf"."sasSteeringAngleSpeed" VARCHAR,
"cf"."sasSteeringAngle" VARCHAR,
"cf"."sasSteeringAngleValid" VARCHAR,
"cf"."espSteeringTorque" VARCHAR,
"cf"."acReq" VARCHAR,
"cf"."acSystemFailure" VARCHAR,
"cf"."ptcPwrAct" VARCHAR,
"cf"."plasmaStatus" VARCHAR,
"cf"."battInTemperature" VARCHAR,
"cf"."battWarmLoopSts" VARCHAR,
"cf"."battCoolngLoopSts" VARCHAR,
"cf"."battCoolActv" VARCHAR,
"cf"."motorOutTemperature" VARCHAR,
"cf"."powerStatusFeedBack" VARCHAR,
"cf"."AC_RearDefrosterSwitch" VARCHAR,
"cf"."rearFoglamp" VARCHAR,
"cf"."driverDoorLock" VARCHAR,
"cf"."acDriverReqTemp" VARCHAR,
"cf"."keyAlarm" VARCHAR,
"cf"."airCleanStsRemind" VARCHAR,
"cf"."recycleType" VARCHAR,
"cf"."startControlsignal" VARCHAR,
"cf"."airBagWarningLamp" VARCHAR,
"cf"."frontDefrosterSwitch" VARCHAR,
"cf"."frontBlowType" VARCHAR,
"cf"."frontReqWindLevel" VARCHAR,
"cf"."bcmFrontWiperStatus" VARCHAR,
"cf"."tmsPwrAct" VARCHAR,
"cf"."keyUndetectedAlarmSign" VARCHAR,
"cf"."positionLamp" VARCHAR,
"cf"."driverReqTempModel" VARCHAR,
"cf"."turnLightSwitchSts" VARCHAR,
"cf"."autoHeadlightStatus" VARCHAR,
"cf"."driverDoor" VARCHAR,
"cf"."IpuFaultCodes" VARCHAR,
"cf"."frntIpuFltRnk" VARCHAR,
"cf"."frontIpuSwVers" VARCHAR,
"cf"."frontIpuHwVers" VARCHAR,
"cf"."frntMotTqLongTermMax" VARCHAR,
"cf"."frntMotTqLongTermMin" VARCHAR,
"cf"."cpvValue" VARCHAR,
"cf"."obcChrgSts" VARCHAR,
"cf"."obcFltRnk" VARCHAR,
"cf"."obcChrgInpAcI" VARCHAR,
"cf"."obcChrgInpAcU" VARCHAR,
"cf"."obcChrgDcI" VARCHAR,
"cf"."obcChrgDcU" VARCHAR,
"cf"."obcTemperature" VARCHAR,
"cf"."obcMaxChrgOutpPwrAvl" VARCHAR,
"cf"."passengerBuckleSwitch" VARCHAR,
"cf"."crashlfo" VARCHAR,
"cf"."driverBuckleSwitch" VARCHAR,
"cf"."engineStartHibit" VARCHAR,
"cf"."lockCommand" VARCHAR,
"cf"."searchCarReq" VARCHAR,
"cf"."acTempValueReq" VARCHAR,
"cf"."VcuFaultCode" VARCHAR,
"cf"."vcuErrAmnt" VARCHAR,
"cf"."vcuSwVers" VARCHAR,
"cf"."vcuHwVers" VARCHAR,
"cf"."lowSpdWarnStatus" VARCHAR,
"cf"."lowBattChrgRqe" VARCHAR,
"cf"."lowBattChrgSts" VARCHAR,
"cf"."lowBattU" VARCHAR,
"cf"."handlebrakeStatus" VARCHAR,
"cf"."shiftPositionValid" VARCHAR,
"cf"."accPedalValid" VARCHAR,
"cf"."driveMode" VARCHAR,
"cf"."driveModeButtonStatus" VARCHAR,
"cf"."VCUSRSCrashOutpSts" VARCHAR,
"cf"."textDispEna" VARCHAR,
"cf"."crsCtrlStatus" VARCHAR,
"cf"."crsTarSpd" VARCHAR,
"cf"."crsTextDisp" VARCHAR,
"cf"."keyOn" VARCHAR,
"cf"."vehPwrlim" VARCHAR,
"cf"."vehCfgInfo" VARCHAR,
"cf"."vacBrkPRmu" VARCHAR,
"cf"."processTime" VARCHAR
);
```

### 创建二级索引

建立global index，生产环境数据分布在多个region上,由于创建的视图，数据写入hbase数据的性能已优化，需要查询效率高，因此选择全局索引

```sql
create index "vehicle_rightdata_index" on "vehicle_rightdata"("cf"."vin", "cf"."terminalTime", "cf"."soc") ;
```

### 车辆明细数据表及视图

创建hbase车辆指标即席查询明细表：

```sql
create "vehicle_rightdata_detail","cf"
```

创建phoenix关联hbase查询明细视图：

```sql
create view if not exists "vehicle_rightdata_detail"(
rowKey VARCHAR PRIMARY KEY,
"cf"."vin" VARCHAR,
"cf"."terminalTime" VARCHAR,
"cf"."currentElectricity" VARCHAR,
"cf"."remainPower" VARCHAR,
"cf"."fuelConsumption100km" VARCHAR,
"cf"."engineSpeed" VARCHAR,
"cf"."vehicleSpeed" VARCHAR,
"cf"."processTime" VARCHAR
);
```

