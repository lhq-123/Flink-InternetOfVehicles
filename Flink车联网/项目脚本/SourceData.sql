create database if not exists vehicle_ods location "/user/hive/apps/warehouse/flinkcar/vehicle_ods";
use vehicle_ods;
--创建正确数据表
create external table IF NOT EXISTS vehicle_ods.vehicle_rightdata (
                                          vin string,
                                          terminalTime string,
                                          soc bigint,
                                          lat double,
                                          lng double,
                                          gearDriveForce bigint,
                                          batteryConsistencyDifferenceAlarm bigint,
                                          socJumpAlarm bigint,
                                          caterpillaringFunction bigint,
                                          satNum bigint,
                                          socLowAlarm bigint,
                                          chargingGunConnectionState bigint,
                                          minTemperatureSubSystemNum bigint,
                                          chargedElectronicLockStatus bigint,
                                          maxVoltageBatteryNum bigint,
                                          singleBatteryOverVoltageAlarm bigint,
                                          otherFaultCount bigint,
                                          vehicleStorageDeviceOvervoltageAlarm bigint,
                                          brakeSystemAlarm bigint,
                                          serverTime string,
                                          rechargeableStorageDevicesFaultCount bigint,
                                          driveMotorTemperatureAlarm bigint,
                                          gearBrakeForce bigint,
                                          dcdcStatusAlarm bigint,
                                          driveMotorFaultCodes string,
                                          deviceType string,
                                          vehicleSpeed bigint,
                                          chargingTimeExtensionReason bigint,
                                          currentBatteryStartNum bigint,
                                          batteryVoltage string,
                                          chargeSystemVoltage double,
                                          currentBatteryCount bigint,
                                          batteryCount bigint,
                                          childSystemNum bigint,
                                          chargeSystemCurrent double,
                                          gpsTime string,
                                          engineFaultCount bigint,
                                          carId string,
                                          currentElectricity double,
                                          singleBatteryUnderVoltageAlarm bigint,
                                          maxVoltageBatterySubSystemNum bigint,
                                          minTemperatureProbe bigint,
                                          driveMotorNum bigint,
                                          totalVoltage double,
                                          temperatureDifferenceAlarm bigint,
                                          maxAlarmLevel bigint,
                                          status bigint,
                                          geerPosition bigint,
                                          averageEnergyConsumption double,
                                          minVoltageBattery double,
                                          geerStatus bigint,
                                          controllerInputVoltage double,
                                          controllerTemperature bigint,
                                          revolutionSpeed bigint,
                                          num bigint,
                                          controllerDcBusCurrent double,
                                          temperature double,
                                          torque double,
                                          state bigint,
                                          minVoltageBatteryNum bigint,
                                          validGps string,
                                          engineFaultCodes string,
                                          mbigintemperatureValue bigint,
                                          chargeStatus bigint,
                                          ignitionTime string,
                                          totalOdometer double,
                                          alti double,
                                          speed double,
                                          socHighAlarm bigint,
                                          vehicleStorageDeviceUndervoltageAlarm bigint,
                                          totalCurrent double,
                                          batteryAlarm bigint,
                                          rechargeableStorageDeviceMismatchAlarm bigint,
                                          isHistoryPoi bigint,
                                          vehiclePureDeviceTypeOvercharge bigint,
                                          maxVoltageBattery double,
                                          dcdcTemperatureAlarm bigint,
                                          isValidGps string,
                                          lastUpdatedTime string,
                                          driveMotorControllerTemperatureAlarm bigint,
                                          probeTemperatures string,
                                          chargeTemperatureProbeNum bigint,
                                          igniteCumulativeMileage double,
                                          dcStatus bigint,
                                          repay string,
                                          maxTemperatureSubSystemNum bigint,
                                          carStatus bigint,
                                          minVoltageBatterySubSystemNum bigint,
                                          heading double,
                                          driveMotorFaultCount string,
                                          tuid string,
                                          energyRecoveryStatus bigint,
                                          fireStatus bigint,
                                          targetType string,
                                          maxTemperatureProbe bigint,
                                          rechargeableStorageDevicesFaultCodes string,
                                          carMode bigint,
                                          highVoltagebiginterlockStateAlarm bigint,
                                          insulationAlarm bigint,
                                          mileageInformation bigint,
                                          maxTemperatureValue bigint,
                                          otherFaultCodes string,
                                          remainPower double,
                                          insulateResistance bigint,
                                          batteryLowTemperatureHeater bigint,
                                          fuelConsumption100km string,
                                          fuelConsumption string,
                                          engineSpeed string,
                                          engineStatus string,
                                          trunk bigint,
                                          lowBeam bigint,
                                          triggerLatchOverheatProtect string,
                                          turnLndicatorRight bigint,
                                          highBeam bigint,
                                          turnLndicatorLeft bigint,
                                          bcuSwVers bigint,
                                          bcuHwVers bigint,
                                          bcuOperMod bigint,
                                          chrgEndReason bigint,
                                          BCURegenEngDisp string,
                                          BCURegenCpDisp bigint,
                                          bcuChrgMod bigint,
                                          batteryChargeStatus bigint,
                                          BcuFaultCodes string,
                                          bcuFltRnk bigint,
                                          battPoleTOver string,
                                          bcuSOH double,
                                          battIntrHeatActive bigint,
                                          battIntrHeatReq bigint,
                                          BCUBattTarT string,
                                          battExtHeatReq bigint,
                                          BCUMaxChrgPwrLongT string,
                                          BCUMaxDchaPwrLongT string,
                                          BCUTotalRegenEngDisp string,
                                          BCUTotalRegenCpDisp string,
                                          dcdcFltRnk bigint,
                                          DcdcFaultCode string,
                                          dcdcOutpCrrt double,
                                          dcdcOutpU double,
                                          dcdcAvlOutpPwr bigint,
                                          absActiveStatus string,
                                          absStatus string,
                                          VcuBrkErr string,
                                          EPB_AchievedClampForce string,
                                          epbSwitchPosition string,
                                          epbStatus string,
                                          espActiveStatus string,
                                          espFunctionStatus string,
                                          ESP_TCSFailStatus string,
                                          hhcActive string,
                                          tcsActive string,
                                          espMasterCylinderBrakePressure string,
                                          ESP_MasterCylinderBrakePressureValid string,
                                          espTorqSensorStatus string,
                                          EPS_EPSFailed string,
                                          sasFailure string,
                                          sasSteeringAngleSpeed string,
                                          sasSteeringAngle string,
                                          sasSteeringAngleValid string,
                                          espSteeringTorque string,
                                          acReq bigint,
                                          acSystemFailure bigint,
                                          ptcPwrAct double,
                                          plasmaStatus bigint,
                                          battInTemperature bigint,
                                          battWarmLoopSts string,
                                          battCoolngLoopSts string,
                                          battCoolActv string,
                                          motorOutTemperature bigint,
                                          powerStatusFeedBack string,
                                          AC_RearDefrosterSwitch bigint,
                                          rearFoglamp bigint,
                                          driverDoorLock bigint,
                                          acDriverReqTemp double,
                                          keyAlarm bigint,
                                          airCleanStsRemind bigint,
                                          recycleType bigint,
                                          startControlsignal string,
                                          airBagWarningLamp bigint,
                                          frontDefrosterSwitch bigint,
                                          frontBlowType string,
                                          frontReqWindLevel bigint,
                                          bcmFrontWiperStatus string,
                                          tmsPwrAct string,
                                          keyUndetectedAlarmSign bigint,
                                          positionLamp string,
                                          driverReqTempModel bigint,
                                          turnLightSwitchSts bigint,
                                          autoHeadlightStatus bigint,
                                          driverDoor bigint,
                                          IpuFaultCodes string,
                                          frntIpuFltRnk bigint,
                                          frontIpuSwVers string,
                                          frontIpuHwVers bigint,
                                          frntMotTqLongTermMax bigint,
                                          frntMotTqLongTermMin bigint,
                                          cpvValue bigint,
                                          obcChrgSts bigint,
                                          obcFltRnk string,
                                          ObcFaultCode string,
                                          obcChrgInpAcI double,
                                          obcChrgInpAcU bigint,
                                          obcChrgDcI double,
                                          obcChrgDcU double,
                                          obcTemperature bigint,
                                          obcMaxChrgOutpPwrAvl bigint,
                                          passengerBuckleSwitch bigint,
                                          crashlfo string,
                                          driverBuckleSwitch bigint,
                                          engineStartHibit string,
                                          lockCommand string,
                                          searchCarReq string,
                                          acTempValueReq string,
                                          VcuFaultCode string,
                                          vcuErrAmnt string,
                                          vcuSwVers bigint,
                                          vcuHwVers bigint,
                                          lowSpdWarnStatus string,
                                          lowBattChrgRqe bigint,
                                          lowBattChrgSts string,
                                          lowBattU double,
                                          handlebrakeStatus bigint,
                                          shiftPositionValid string,
                                          accPedalValid string,
                                          driveMode bigint,
                                          driveModeButtonStatus bigint,
                                          VCUSRSCrashOutpSts bigint,
                                          textDispEna bigint,
                                          crsCtrlStatus bigint,
                                          crsTarSpd bigint,
                                          crsTextDisp bigint,
                                          keyOn bigint,
                                          vehPwrlim bigint,
                                          vehCfgInfo string,
                                          vacBrkPRmu bigint,
                                          processTime string
)
PARTITIONED BY (dt string)
STORED AS ORC
location '/user/hive/apps/warehouse/flinkcar/vehicle_ods/vehicle_rightdata'
TBLPROPERTIES ('orc.compress'='SNAPPY');

alter table vehicle_ods.vehicle_rightdata add partition (dt="20210811") location "/user/hive/apps/warehouse/flinkcar/vehicle_ods/vehicle_rightdata/20210811";

--创建错误数据表
create external table IF NOT EXISTS vehicle_ods.vehicle_errordata (json string) partitioned by(dt String) 
STORED AS ORC 
location '/user/hive/apps/warehouse/flinkcar/vehicle_ods/vehicle_errordata'
TBLPROPERTIES ('orc.compress'='SNAPPY');

alter table vehicle_ods.vehicle_errordata add partition (dt="20210811") location "/user/hive/apps/warehouse/flinkcar/vehicle_ods/vehicle_errordata/20210811";

